#!/bin/sh -e

# Remove source package and all related DEB package(s)
# from an APT repository.
# This includes removing the files from the repository dirs
# and updating an index files of the repository (with PGP
# signing, if configured).

if [ -z "$1" ]; then
    echo "Usage: $0 <packagename>" 1>&2
    exit 1
fi

. /etc/dbd/dbd.conf
sudo -n /usr/bin/reprepro \
    --basedir /var/www/dbd-apt \
    removesrc "$DISTRIBUTION" "$1"
